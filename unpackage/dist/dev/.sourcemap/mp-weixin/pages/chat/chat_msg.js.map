{"version":3,"sources":["uni-app:///main.js","webpack:///E:/键盘敲烂/ourChat - H5/pages/chat/chat_msg.vue?8145","webpack:///E:/键盘敲烂/ourChat - H5/pages/chat/chat_msg.vue?e9f6","webpack:///E:/键盘敲烂/ourChat - H5/pages/chat/chat_msg.vue?4c46","webpack:///E:/键盘敲烂/ourChat - H5/pages/chat/chat_msg.vue?8d26","uni-app:///pages/chat/chat_msg.vue"],"names":["createPage","Page"],"mappings":"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","file":"pages/chat/chat_msg.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/chat/chat_msg.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./chat_msg.vue?vue&type=template&id=03246a70&\"\nvar renderjs\nimport script from \"./chat_msg.vue?vue&type=script&lang=js&\"\nexport * from \"./chat_msg.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/chat/chat_msg.vue\"\nexport default component.exports","export * from \"-!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat_msg.vue?vue&type=template&id=03246a70&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat_msg.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../XB/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat_msg.vue?vue&type=script&lang=js&\"","<template>\n\t<view>\r\n\t\t<nav-bar showBack title=\"聊天信息\" :showRight=\"false\" >\r\n\t\t</nav-bar>\r\n\t\t<!-- 成员 -->\r\n\t\t\r\n\t\t<view class=\"flex flex-wrap flex-row  py-3  bg-white\">\r\n\t\t\t<view class=\"\" v-if=\"detail.chat_type === 'user' \">\r\n\t\t\t\t<view class=\"flex align-center\"   >\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"flex flex-column align-center  px-1\">\r\n\t\t\t\t\t\t<free-avatar  :type=\"'flex'\" :src=\"detail.avatar ? detail.avatar: '../../static/default.jpg'\" :size=\"120\"></free-avatar>\r\n\t\t\t\t\t\t<text class=\"font text-muted mb-2\">{{detail.name}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view> \r\n\t\t\t</view>\r\n\t\t\t<view class=\"flex flex-wrap flex-row  py-3  bg-white\" v-else>\r\n\t\t\t\t<view class=\"flex flex-column align-center  px-1\" v-for=\"(item,index) in groupInfo.group_users\" :key = \"index\">\r\n\t\t\t\t\t\t\t\t\t<free-avatar :type=\"'flex'\" :src=\"item.userInfo.avatar ? item.userInfo.avatar : '../../static/default.jpg'\" :size=\"120\" rounded></free-avatar>\r\n\t\t\t\t\t\t\t\t\t<text class=\"font text-muted mb-2\">{{item.nickname ? item.nickname : (item.userInfo.nickname ? item.userInfo.nickname : item.userInfo.username ) }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<view @click=\"inviteToGroup\" class=\"flex flex-column align-center justify-center mb-2\" style=\"width: 150rpx;\">\r\n\t\t\t\t<text class=\"text-light-muted border text-center\" style=\"font-size: 100rpx;width: 120rpx;height: 120rpx;line-height: 120rpx;\">+</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!-- 成员 -->\r\n\t\t<divider :height=\"20\"></divider>\r\n\t\t<view class=\"\" v-if=\"detail.chat_type === 'group'\">\r\n\t\t\t<list-item @click=\"showConfirm('group_name')\" :title=\"'群聊名称'\" :rightText=\"groupInfo.name\" showRight>\r\n\t\t\t</list-item>\r\n\t\t\t<list-item :title=\"'群二维码'\" @click = 'openCode'  :rightText=\"'\\ue614'\" showRight></list-item>\r\n\t\t\t<list-item :title=\"'群公告'\" @click=\"showConfirm('group_remark')\" :rightText=\"groupInfo.remark\"  showRight></list-item>\r\n\t\t\t<list-item @click=\"navTo('group_user?id='+detail.id)\" :title=\"'删除群成员'\" v-if=\"isAdmin\"  showRight></list-item>\r\n\t\t\t<divider :height=\"20\"></divider>\r\n\t\t</view>\r\n\t\t\r\n\t\t<list-item :title=\"'查找聊天记录'\" @click= \"navTo\"  showRight></list-item>\r\n\t\t<divider :height=\"20\"></divider>\r\n\t    <list-item :title=\"'消息免打扰'\" >\r\n\t\t\t<switch slot=\"rightImg\" :checked=\"currentChat.nowarn\"  @change=\"changeConfig($event,'nowarn')\"></switch>\r\n\t\t</list-item>\r\n\t\t<list-item :title=\"'置顶聊天'\"  >\r\n\t\t\t<switch slot=\"rightImg\" :checked=\"currentChat.istop\"  @change=\"changeConfig($event,'istop')\" ></switch>\r\n\t\t</list-item>\r\n\t\t<list-item :title=\"'强提醒'\"  >\r\n\t\t\t<switch @change=\"changeConfig($event,'strongwarn')\" :checked=\"currentChat.strongwarn\"  slot=\"rightImg\"></switch>\r\n\t\t</list-item>\r\n\t\t<divider :height=\"20\"></divider>\r\n\t\t<view class=\"\" v-if=\"detail.chat_type === 'group'\">\r\n\t\t\t<list-item @click=\"showConfirm('group_nickname')\" :title=\"'我在本群名称'\" :rightText=\"currentUserInGroup.nickname || user.username \" showRight></list-item>\r\n\t\t\t<list-item :title=\"'显示群聊成员昵称'\"  >\r\n\t\t\t\t<switch slot=\"rightImg\" @change=\"changeConfig($event,'shownickname')\" :checked=\"currentChat.shownickname\" ></switch>\r\n\t\t\t</list-item>\r\n\t\t\t<divider :height=\"20\"></divider>\r\n\t\t</view>\r\n\t\t\r\n\t\t<list-item :title=\"'设置当前聊天背景'\"  showRight></list-item>\r\n\t\t<list-item :title=\"'投诉'\"  showRight></list-item>\r\n\t\t<divider :height=\"20\"></divider>\r\n\t\t<list-item :title=\"'清空聊天记录'\" @click=\"clearChat\"  showRight></list-item>\r\n\t\t<divider :height=\"20\"></divider>\r\n\t\t<view @click=\"exit\" class=\"bg-white flex align-center justify-center\" style=\"height: 100rpx;\">\r\n\t\t\t<text class=\"text-danger\">{{detail.chat_type === 'group' ? (isAdmin ? '删除并解散该群': '退出该群' ) : '删除好友'}}</text>\r\n\t\t</view>\r\n\t\t<divider :height=\"40\" ></divider>\r\n\t\t<free-confirm ref=\"confirm\" :bodyHeight=\"300\" :confirmColor=\"'#007AFF'\" >\r\n\t\t\t<view class=\"pt-1\">\r\n\t\t\t\t<text class=\"m-2 text-center font-weight-bold\" style=\"font-size: 40rpx;\" >{{confirmTitle}}</text>\r\n\t\t\t\t<input v-if=\"chooseType !== 'group_remark'\" class=\"m-4 border-bottom\" type=\"text\" v-model=\"text\" :placeholder=\"placeHolder\"  />\r\n\t\t\t\t<textarea v-else class=\"ml-4  border-bottom\" style=\"height: 150rpx;width: 500rpx;\" v-model=\"remark\" :placeholder=\"groupInfo.remark\" ></textarea>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t</free-confirm>\r\n\t</view>\r\n</template>\n\n<script>\r\n\timport freeConfirm from '../../components/free-ui/free-confirm.vue'\r\n\timport divider from '../../components/free-ui/free-divider.vue'\r\n\timport freeAvatar from '../../components/free-ui/free-avatar.vue'\r\n\timport navBar from '../../components/free-ui/free-nav.vue'\r\n\timport listItem from '../../components/free-ui/free-list-item.vue'\r\n\timport {mapState} from 'vuex'\n\texport default {\n\t\tcomponents:{\r\n\t\t\tnavBar,\r\n\t\t\tfreeAvatar,\r\n\t\t\tlistItem,\r\n\t\t\tdivider,\r\n\t\t\tfreeConfirm\r\n\t\t},\r\n\t\tonLoad(e) {\r\n\t\t\tif(!e.params) {\r\n\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\tdelta:1\r\n\t\t\t\t})\r\n\t\t\t\tthis.toast('无效参数')\r\n\t\t\t}\r\n\t\t\tlet detail = JSON.parse(decodeURIComponent(e.params))\r\n\t\t\tdetail = this.chat.getChatListItem(detail.id,detail.chat_type)\r\n\t\t\tif(!detail) return \r\n\t\t\tthis.detail = detail\r\n\t\t\tif(this.detail.chat_type === 'group') this.getGroupInfo()\r\n\t\t\tconsole.log('detail',this.detail)\r\n\t\t\tthis.$store.dispatch('getContacts')\r\n\t\t\tconsole.log(this.currentChat)\r\n\t\t},\r\n\t\tmethods:{\r\n\t\t\t\r\n\t\t\tclearChat() {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\tconfirmText:'确定',\r\n\t\t\t\t\tcancelText:'取消',\r\n\t\t\t\t\tconfirmColor:'#FA5251',\r\n\t\t\t\t\ttitle:'是否清除聊天记录',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tif(res.confirm){\r\n\t\t\t\t\t\t\tthis.chat.clearChatItem({id:this.detail.id,chat_type:this.detail.chat_type})\r\n\t\t\t\t\t\t\tuni.$emit('clearChatList')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\topenCode() {\r\n\t\t\t\tlet obj = {\r\n\t\t\t\t\tid:this.detail.id,\r\n\t\t\t\t\tavatar: this.detail.avatar ? this.detail.avatar  :'../../static/groupdefault.jpg'  ,\r\n\t\t\t\t\tnickname:this.detail.name,\r\n\t\t\t\t\ttype:'group'\r\n\t\t\t\t}\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl:'../my/card?params='+encodeURIComponent(JSON.stringify(obj))\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tchangeConfig(e,key) {\r\n\t\t\t\tthis.detail[key] = e.target.value\r\n\t\t\t\tconsole.log(key,e.target.value)\r\n\t\t\t\tthis.chat.updateChatItem({\r\n\t\t\t\t\tid:this.detail.id,\r\n\t\t\t\t\tchat_type:this.detail.chat_type\r\n\t\t\t\t},this.detail)\r\n\t\t\t},\r\n\t\t\t// 拉群\r\n\t\t\tinviteToGroup() {\r\n\t\t\t\tif(this.detail.chat_type === 'group')\r\n\t\t\t\t{\r\n\t\t\t\t\treturn uni.navigateTo({\r\n\t\t\t\t\t\turl:'chat_share?type=add&id='+this.detail.id\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl:'chat_share?type=invite'\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tchangeGroupRemark(close) {\r\n\t\t\t\tlet obj = {\r\n\t\t\t\t\tgroup_id:this.detail.id,\r\n\t\t\t\t\tremark:this.remark\r\n\t\t\t\t}\r\n\t\t\t\tthis.$http.post('/remark',obj)\r\n\t\t\t\t.then(res=>{\r\n\t\t\t\t\tthis.toast('修改成功')\r\n\t\t\t\t\tthis.groupInfo.remark = this.remark\r\n\t\t\t\t\tthis.remark = ''\r\n\t\t\t\t\tthis.$refs.confirm.cancel()\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 修改群名称\r\n\t\t\tchangeGroupName(close) {\r\n\t\t\t\tlet obj = {\r\n\t\t\t\t\tgroup_id:this.detail.id,\r\n\t\t\t\t\tgroup_name:this.text\r\n\t\t\t\t}\r\n\t\t\t\tthis.$http.post('/name/group',obj)\r\n\t\t\t\t.then(res=>{\r\n\t\t\t\t\tthis.toast('修改成功')\r\n\t\t\t\t\tthis.groupInfo.name = this.text\r\n\t\t\t\t\tuni.$emit('changeGroupName',this.text)\r\n\t\t\t\t\tthis.text = ''\r\n\t\t\t\t\tif(close) close()\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 修改我在群中的名称\r\n\t\t\tchangeGroupNickname(close) {\r\n\t\t\t\tlet obj = {\r\n\t\t\t\t\tgroup_id:this.detail.id,\r\n\t\t\t\t\tgroup_nickname:this.text\r\n\t\t\t\t}\r\n\t\t\t\tthis.$http.post('/nickname/group',obj)\r\n\t\t\t\t.then(res=>{\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.toast('修改成功')\r\n\t\t\t\t\tthis.currentUserInGroup.nickname = this.text\r\n\t\t\t\t\tlet index = this.groupInfo.group_users.findIndex(v=>v.user_id === this.user.id)\r\n\t\t\t\t\tthis.groupInfo.group_users[index].nickname = this.text\r\n\t\t\t\t\tthis.text = ''\r\n\t\t\t\t\tthis.$refs.confirm.cancel()\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tshowConfirm(type) {\r\n\t\t\t\t// 不是管理员不让修改\r\n\t\t\t\tif(!this.isAdmin && type != 'group_nickname') return this.toast('只有管理员才可以修改哦')\r\n\t\t\t\tthis.chooseType = type\r\n\t\t\t\tthis.$refs.confirm.show((close)=>{\r\n\t\t\t\t\tif(!this.text.trim() && !this.remark.trim()) return this.toast('请输入要填写的内容')\r\n\t\t\t\t\tif(type === 'group_name')\r\n\t\t\t\t\tthis.changeGroupName(close)\r\n\t\t\t\t\telse if(type === 'group_remark')\r\n\t\t\t\t\tthis.changeGroupRemark()\r\n\t\t\t\t\telse this.changeGroupNickname()\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 获取群信息\r\n\t\t\tgetGroupInfo() {\r\n\t\t\t\tlet obj = {\r\n\t\t\t\t\tgroup_id:this.detail.id\r\n\t\t\t\t}\r\n\t\t\t\tthis.$http.post('/user/group',obj)\r\n\t\t\t\t.then(res=>{\r\n\t\t\t\t\tthis.groupInfo = {...res}\r\n\t\t\t\t\tlet id =  this.user.id\r\n\t\t\t\t\tlet index = this.groupInfo.group_users.findIndex(v=>v.user_id === id)\r\n\t\t\t\t\tthis.currentUserInGroup = {...this.groupInfo.group_users[index]}\r\n\t\t\t\t\tconsole.log('我在群中的信息',this.currentUserInGroup)\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tnavTo(url = '') {\r\n\t\t\t\tif(url)\r\n\t\t\t\treturn uni.navigateTo({\r\n\t\t\t\t\turl\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl:`chat_history?chat_type=${this.detail.chat_type}&id=${this.detail.id}&name=${this.detail.name}`\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\texit() {\r\n\t\t\t\tif(this.detail.chat_type === 'user') {\r\n\t\t\t\t\t//删除好友\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcancelText:'取消',\r\n\t\t\t\t\t\tconfirmColor:'#FA5251',\r\n\t\t\t\t\t\tconfirmText:'确定',\r\n\t\t\t\t\t\ttitle:'是否删除该好友',\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tif(res.confirm) {\r\n\t\t\t\t\t\t\t\tlet obj = {\r\n\t\t\t\t\t\t\t\t\tfriend_id:this.detail.id\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.$http.post('/breakup',obj)\r\n\t\t\t\t\t\t\t\t.then(res=>{\r\n\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\ttitle:'删除成功',\r\n\t\t\t\t\t\t\t\t\t\ticon:'none',\r\n\t\t\t\t\t\t\t\t\t\tmask:true\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\t\t\t\t\tuni.reLaunch({\r\n\t\t\t\t\t\t\t\t\t\t\turl:'../index/index'\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t},600)\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcancelText:'取消',\r\n\t\t\t\t\t\tconfirmColor:'#FA5251',\r\n\t\t\t\t\t\tconfirmText:'确定',\r\n\t\t\t\t\t\ttitle:'解散/退出该群',\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tif(res.confirm) {\r\n\t\t\t\t\t\t\t\tlet obj = {\r\n\t\t\t\t\t\t\t\t\tgroup_id:this.detail.id\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.$http.post('/exit/group',obj)\r\n\t\t\t\t\t\t\t\t.then(res=>{\r\n\t\t\t\t\t\t\t\t\tthis.toast('操作成功')\r\n\t\t\t\t\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\t\t\t\t\t\turl:'../index/index'\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t},500)\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata(){\r\n\t\t\treturn {\r\n\t\t\t\tremark:'',\r\n\t\t\t\tdetail:{\r\n\t\t\t\t\tid:0,\r\n\t\t\t\t\tchat_type:'user',\r\n\t\t\t\t\tavatar:'',\r\n\t\t\t\t\tname:'',\r\n\t\t\t\t\tistop:false,\t//是否置顶\r\n\t\t\t\t\tshownickname:0,  //是否显示昵称\r\n\t\t\t\t\tnowarn:0,\t//消息免打扰,\r\n\t\t\t\t\tstrongwarn:0,\t//是否开启强提醒\r\n\t\t\t\t\tuser_id:0,\t//群管理员id\r\n\t\t\t\t\tremark:'',\r\n\t\t\t\t\tinvite_confirm:0\t//邀约确认\r\n\t\t\t\t},\r\n\t\t\t\tgroupInfo:{},\r\n\t\t\t\tcurrentUserInGroup:{},\r\n\t\t\t\tchooseType:'',\r\n\t\t\t\ttext:''\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed:{\r\n\t\t\t...mapState({\r\n\t\t\t\tchatList:state=>state.user.chatList,\r\n\t\t\t\tchat:state=>state.user.chat,\r\n\t\t\t\tuser:state=>state.user.user\r\n\t\t\t}),\r\n\t\t\tcurrentChat() {\r\n\t\t\t\tlet index = this.chatList.findIndex(v=>{\r\n\t\t\t\t\treturn v.id == this.detail.id && v.chat_type === this.detail.chat_type\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tif(index === -1 ) return {}\r\n\t\t\t\treturn this.chatList[index]\r\n\t\t\t},\r\n\t\t\tconfirmTitle() {\r\n\t\t\t\tif(this.chooseType === 'group_name') return '修改群名称'\r\n\t\t\t\telse if(this.chooseType === 'group_remark') return '修改群公告'\r\n\t\t\t\telse return '修改我在群聊中的名称'\r\n\t\t\t},\r\n\t\t\tplaceHolder() {\r\n\t\t\t\tif(this.chooseType === 'group_remark') return '填写群公告'\r\n\t\t\t\treturn '填写名称'\r\n\t\t\t},\r\n\t\t\tisAdmin() {\r\n\t\t\t\tif(this.detail.chat_type === 'user') return false\r\n\t\t\t\treturn this.user.id === this.groupInfo.user_id\r\n\t\t\t}\r\n\t\t}\r\n\t\t\n\t}\n</script>\n\n<style>\n\n</style>\n"],"sourceRoot":""}